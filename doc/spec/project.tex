% ==============================================================================
%  $RCSfile: project.tex,v $, $Revision: 1.21 $
%  $Date: 2003/03/27 07:14:46 $
%  $Author: stupro $
%
%  Description:
%
% ==============================================================================


%===================
\section {Persistenz der Projekte}

GIANT speichert persistente Informationen in sogenannten Projekten.
\begin {enumerate}

  \item
  Die gesamte in dieser Spezifikation beschriebene Funktionalität, die
  sich auf das Laden bestehender und das öffnen neuer Projekte während
  der Laufzeit von GIANT bezieht, kann nur implementiert werden, 
  falls die Reflektion zur Bauhaus IML-Graph Bibliothek dies unterstützt.
  Der Kunde muss hierzu in der Reflektion die Möglichkeit vorsehen, 
  IML-Graphen zur Laufzeit laden und bereits geladene IML-Graphen zur
  Laufzeit aus dem Speicher entfernen zu können.
    
  \item
  Zur sicheren Identifikation der IML-Graph Datei, 
  die zu einem Projekt gehört, muss über die Reflektion eine eindeutige
  Prüfsumme für jeden IML-Graphen berechnet werden können.

  \item 
  Wird während des Betriebs von GIANT ein neues Projekt angelegt, so erhält 
  es automatisch eine Projektdatei.
  
  \item
  Ein Projekt besteht aus einem Verweis auf eine IML-Graph-Datei, auf die sich
  die gespeicherten Informationen beziehen, sowie aus den gespeicherten 
  Informationen für IML-Teilgraphen, Anzeigefenster und Knoten-Annotationen.
 
  \item
  Der Name eines bereits angelegten Projektes kann mit den Mitteln von 
  GIANT nicht geändert werden (außer dadurch, dass  man das Projekt unter 
  neuem Namen neu speichert). 

  \item
  Der Benutzer kann beliebig viele Projekte anlegen.
  
  \item
  In GIANT darf immer nur ein Projekt gleichzeitig geöffnet sein. 
  
  \item
  Während der Arbeit mit GIANT kann jederzeit ein vorhandenes Projekt 
  geladen oder ein neues Projekt angelegt werden. 

\end {enumerate}


  \subsection {Das Projektverzeichnis}
  \begin {enumerate}

    \item  
    Sämtliche Dateien, die die Informationen für ein Projekt enthalten,
    befinden sich in diesem Verzeichnis. 

    \item
    In einem Projektverzeichnis darf nur ein Projekt abgelegt werden.
    
  \end {enumerate}    


  \subsection {Die Projektdatei}
  \begin {enumerate}

    \item
    Die Projektdatei liegt als XML-Datei vor.

    \item
    Die Projektdatei befindet sich im Projektverzeichnis und enthält 
    Informationen, die zur Identifikation des zu einem Projekt gehörenden 
    IML-Graphen nötig sind. 
  
    \item
    Der Name der Projektdatei entspricht dem Namen des Projektes.

    \item
    Die Projektdatei enthält Referenzen zu allen Dateien, die Bestandteil
    des Projektes sind (Verwaltungsdateien für IML-Teilgraphen und
    Anzeigefenster und die Verwaltungsdatei für Knoten-Annotationen).

    \item
    Der Pfad zu der Datei, die den IML-Graphen enthält, ist in der Projektdatei 
    gespeichert. 
  \end {enumerate}
  
 
  \subsection {Prüfung der IML-Graph Datei}
  Beim Laden eines Projektes wird überprüft, 
  ob die in der Projektdatei gespeicherte Prüfsumme
  der Prüfsumme der zu ladenden IML-Graph Datei entspricht. 
  Das Verhalten von GIANT für den Fall, dass eine IML-Graph Datei geladen wird, 
  die zwar die passende Prüfsumme hat, aber nicht den IML-Graphen enthält, 
  der dem Projekt eigentlich zu Grunde liegt, ist undefiniert.


  \subsection {Verwaltungsdateien für Anzeigefenster}
 
  \begin {enumerate}
  
    \item
    Diese Datei ist eine Binärdatei.
  
    \item
    Zu jedem Anzeigefenster gibt es eine Verwaltungsdatei. 
    
    \item
    Diese Verwaltungsdatei enthält alle Informationen zur kompletten 
    Rekonstruktion eines Anzeigefensters. Alle Informationen werden
    in binärer Form gespeichert.
 
  \end {enumerate}
  Insbesondere werden folgende Informationen gespeichert:
 
  \begin {enumerate}
 
    \item Der komplette Anzeigeinhalt 
          (alle visualisierten Knoten und Kanten mit Position).
    \item Alle Pins (gespeicherte sichtbare Anzeigeinhalte).
    \item Alle Selektionen des Anzeigefensters.
 
  \end {enumerate}
 
  Der für das Anzeigefenster gewählte Visualisierungsstiel wird zwar mit 
  gespeichert, da die Viualisierungsstiele völlig unabhängig von den 
  Projekten über Konfigurationsdateien realisiert werden, 
  kann nicht gerantiert werden, dass der gewünschte Stiel beim Laden 
  des Projektes auch wieder gefunden wird,
  in diesem Fall wird dann ein \gq{Standard-Stil} verwendet.


  \subsection {Verwaltungsdateien für IML-Teilgraphen}
  \begin {enumerate}
  
    \item
    Diese Datei ist eine Binärdatei.

    \item
    Für jeden IML-Teilgraphen gibt es eine eigene Verwaltungsdatei.
    
    \item
    Sämtliche erzeugten IML-Teilgraphen werden in Verwaltungsdateien in 
    binärer Form gespeichert. 

  \end{enumerate}
  
  
  \subsection {Die Verwaltungsdatei für Knoten-Annotationen}
  \begin {enumerate}
  
   \item
   Diese Datei liegt als XML Datei vor.

   \item
   Alle Knoten-Annotationen werden in einer Verwaltungsdatei gespeichert.
  
  \end{enumerate}
  

 
 
%===================
\section {Grundlegendes Verhalten von GIANT beim Speichern von Projekten} 
  

  \subsection{\gq{Alles Speichern}}\label{Alles Speichern}
  Diese Funktionalität wird von entsprechenden UseCases genutzt. 
  Hierbei werden alle Anzeigefenster, IML-Teilgraphen 
  und Knoten-Annotationen in die Verwaltungsdateien geschrieben, 
  wobei auch alle Änderungen an noch offenen Anzeigefenstern berücksichtigt 
  werden; d.h. der aktuelle Zustand (z.B. die Position der IML-Knoten)
  der offenen Anzeigefenster wird ohne explizite Rückfrage beim Benutzer
  in die Verwaltungsdateien geschrieben.
  Der Zustand der persistenten Informationen in den Verwaltungsdateien
  entspricht nach Ausführung von \gq{Alles Speichern} exakt dem Zustand 
  des Projektes, der dem aktuellen Bearbeitungsstand innerhalb von
  GIANT entspricht.

  %===
  \subsection {Persistenz von Anzeigefenstern}
  \begin {enumerate}

    \item 
    Beim Speichern von Anzeigefenstern in Verwaltungsdateien werden
    für jedes Anzeigefenster alle Informationen gespeichert, die nötig
    sind um den Zustand des Anzeigefensters zu rekonstruieren, der
    möglichst exakt dem Zustand bei der Speicherung des Anzeigefensters
    entspricht. Inbesondere werden hierbei die folgenden Bestandteile
    des Anzeigefensters gespeichert:

      \subitem
      Alle Selektionen und Pins des Anzeigefensters.

      \subitem
      Der exakte Zustand jeder Selektion; d.h. ob und wie die
      Selektion hervorgehoben ist.

      \subitem
      Die Position der Fenster-Knoten und Fenster-Kanten des 
      Anzeigefensters.

    \item
    Für den gewählten Visualisierungsstil des Anzeigefensters wird
    nur der Name gespeichert, da die Visualisierungstile über
    die Konfigurationsdateien beliebig editiert
    und auch gelöscht werden können. Wird beim Laden eines
    Anzeigefensters aus der Verwaltungsdatei kein Visualisierungstil
    gefunden, dessen Name dem gespeicherten entspricht, so
    wird für das Anzeigefenster statt dessen ein 
    Default-Visualisierungsstil verwendet.
      

    \item
    Sämtliche dem Projekt bekannten Anzeigefenster (alle Anzeigefenster zu 
    denen es eine entsprechende Verwaltungsdatei gibt) werden in 
    der Liste über die Anzeigefenster angezeigt, egal ob sie geöffnet sind
    oder nicht. 
   
    \item 
    Zu jedem Anzeigefenster eines Projektes gibt es eine Verwaltungsdatei.
    Bei neu erzeugten Anzeigefenstern wird diese Verwaltungsdatei beim
    ersten Speichern angelegt.

    \item
    Wird ein geöffnetes Anzeigefenster geschlossen, 
    so fragt GIANT nach, ob es eventuelle Änderungen speichern soll
    oder nicht. Falls ja, werden eventuelle Änderungen in die für das 
    Anzeigefenster vorhandene Verwaltungsdatei geschrieben, 
    anderenfalls bleibt der Zustand des Anzeigefensters nach der letzten
    Speicherung vorhanden (die zugehörige Verwaltungsdatei wird nicht 
    verändert).

    \item
    Modifikationen (z.B. das Verschieben von Knoten) 
    auf einem Anzeigefenster werden nicht automatisch
    nach deren Durchführung gespeichert (so kann notfalls ein
    Undo durchgeführt werden).

  \end {enumerate}

  %===
  \subsection {Persistenz von IML-Teilgraphen}
  \begin {enumerate}

    \item
    Alle in einem Projekt bereits vorhandenen IML-Teilgraphen werden in einer 
    entsprechenden Liste angezeigt.
  
    \item
    Neu erzeugte IML-Teilgraphen und Änderungen an bestehenden 
    IML-Teilgraphen können nur über \gq{Alles Speichern} (siehe oben) 
    gespeichert werden.
       
    \item
    Wird das Programm beendet, ohne das zuvor \gq{Alles Speichern} ausgeführt 
    worden ist, so gehen alle nicht gespeicherten Informationen zu den 
    IML-Teilgraphen verloren (alle zwischenzeitlich ausgeführten Modifikationen 
    und alle zwischenzeitlich neu erzeugten IML-Teilgraphen). 
    Der Zustand nach dem letzten Speichern bleibt dann erhalten.

    \item
    Modifikationen an bestehenden IML-Teilgraphen werden nicht automatisch 
    gespeichert. Zu neu erzeugten IML-Teilgraphen wird nicht automatisch
    eine Verwaltungsdatei erzeugt.
  
    \item
    IML-Teilgraphen können gelöscht werden. Falls vorhanden, wird dann auch
    die entsprechende Verwaltungsdatei ebenfalls sofort gelöscht.
  \end {enumerate}
  
  
  
\subsection {Persistenz von Knoten-Annotationen}
  \begin {enumerate}
  
   \item
   Änderungen bestehender oder neu erzeugte Knoten-Annotationen werden nur
   über die Funktionaliät unter \gq{Alles Speichern} in die 
   Verwaltungsdatei geschrieben.
   
   \item
   Einmal erzeugte Knoten-Annotationen werden jedem IML-Knoten mit der 
   entsprechenden ID zugeordnet, egal in welchem Anzeigefenster diese
   visualisiert sind. Ein Knoten kann auch annotiert sein, wenn er in keinem
   Anzeigefenster visualisiert ist. Wird ein annotierter Knoten gelöscht 
   (aus einem Anzeigefenster entfernt), so wird der dazu vorhandene 
   Eintrag für die Annotation in der Verwaltungsdatei nicht automatisch mit 
   gelöscht.
   
 \end {enumerate}
  
  
  
  
  
  
  
  
  
